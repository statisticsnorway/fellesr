<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fellesr">
<title>R pakkehåndtering med renv og fellesr • fellesr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="R pakkehåndtering med renv og fellesr">
<meta property="og:description" content="fellesr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fellesr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/vignette_dynarev_uttrekk.html">Uttrekk fra Dynarev til R</a>
    <a class="dropdown-item" href="../articles/vignette_renv.html">R pakkehåndtering med renv og fellesr</a>
    <a class="dropdown-item" href="../articles/vignette_SSB_fargepalett.html">SSB fargepalett</a>
    <a class="dropdown-item" href="../articles/vignette_statbank_lasting.html">Lasting til Statbank</a>
    <a class="dropdown-item" href="../articles/vignette__DAPLA_jukseark.html">DAPLA jukseark</a>
    <a class="dropdown-item" href="../articles/web_only/bygge-en-r-tilleggspakke.html">Hvordan å bygge en R-pakke</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>R pakkehåndtering med renv og fellesr</h1>
                        <h4 data-toc-skip class="author">Susie
Jentoft</h4>
            
            <h4 data-toc-skip class="date">2022-12-15</h4>
      
      
      <div class="d-none name"><code>vignette_renv.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="hva-er-renv">Hva er renv?<a class="anchor" aria-label="anchor" href="#hva-er-renv"></a>
</h2>
<p>Det er utrolig mange tilleggspakker tilgjengelig i R. Over tid vil
funksjonalitet i disse pakkene utvikle og endre seg. I en produksjonsløp
har vi behov for stabilitet og at koden kan kjøres på nytt neste kvartal
og neste år.</p>
<p><code>renv</code> er en pakkehåndteringsverktøy som kan brukes til å
forsikre at kode kan kjøres over tid. Det lagres en “lock” fil hvor
versjonsnummer av installerte og brukt pakker lagres. Denne filen kan da
skape det samme miljø med de samme versjonene av pakkene i fremtida og
av forskjellige personer. Disse filer kan pushes opp til github slik at
andre kan bruke de.</p>
</div>
<div class="section level2">
<h2 id="hvordan-installere-jeg-renv">Hvordan installere jeg renv?<a class="anchor" aria-label="anchor" href="#hvordan-installere-jeg-renv"></a>
</h2>
<p>Vi har laget noen tilleggs-funksjoner som gjøre det lettere å ta i
bruk renv på SSB. Disse ligger i felles pakken <code>fellesr</code>.</p>
<p>Hvis renv/fellesr ikke er installert fra før kan du installere dem
med</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/wrathematics/getPass" class="external-link">getPass</a></span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"statisticsnorway/fellesr"</span>, </span>
<span>                         auth_token <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/getPass/man/getPass.html" class="external-link">getPass</a></span><span class="op">(</span><span class="st">"PAT: "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Passordet her er Personal Access Token du har lagret for Github (den
lange med masse tall og tegn).</p>
</div>
<div class="section level2">
<h2 id="hvordan-bruker-jeg-renv">Hvordan bruker jeg renv?<a class="anchor" aria-label="anchor" href="#hvordan-bruker-jeg-renv"></a>
</h2>
<p>For å bruke renv må du først kalle biblioteket:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://statisticsnorway.github.io/fellesr/" class="external-link">fellesr</a></span><span class="op">)</span></span></code></pre></div>
<p>Det er tre oppgaver som er viktig å lære deg for å kunne ta i bruk
renv:</p>
<ul>
<li><a href="#opprett">Opprette og lagre et ny renv miljø til et
prosjekt</a></li>
<li><a href="#bruk">Bruk et eksisterende renv miljø</a></li>
<li><a href="#endre">Endre et eksisterende renv miljø</a></li>
</ul>
<p>Disse blir forklarte i mer detaljer her</p>
<div class="section level3">
<h3 id="opprett">Opprette et nytt renv miljø<a class="anchor" aria-label="anchor" href="#opprett"></a>
</h3>
<p>Første gang renv skal brukes i et prosjekt/produksjonsløp må det
opprettes noen filer. Dette kan gjøres ved</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">init</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Du vil se at en renv mappe nå ligge klar i mappe-struktur. Hvis du
jobber i Dapla/Jupyter trenger du også en fil som spesifisere hvilken
pakke skal brukes som deretter skrives til lock filen. Du kan opprette
denne filen ved</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_dependencies.html">create_dependencies</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Og da er du klar for å jobbe og kjøre koden din!!</p>
<p><img src="https://media.giphy.com/media/scZPhLqaVOM1qG4lT9/giphy.gif"></p>
<p>Installere og bruker de pakkene du ønsker i koden din. Pakken
<code>fellesr</code> inkludere en funksjon
<code><a href="../reference/install.packages.html">install.packages()</a></code> som vil peke til riktig sted å
installere fra og kan dermed brukes i lukket soner på SSB. For
eksempel:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/install.packages.html">install.packages</a></span><span class="op">(</span><span class="va">A3</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">A3</span><span class="op">)</span></span>
<span><span class="fu">a3</span><span class="op">(</span><span class="va">rating</span> <span class="op">~</span> <span class="va">.</span>, <span class="va">attitude</span>, <span class="va">lm</span>, p.acc <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="images/a3Model.PNG" width="264"></p>
<p>Hvis du sliter med å installere en pakke du ønsker og den ligger i
felles installerte pakker can du prøve funksjonen
<code><a href="../reference/ssb_library.html">ssb_library()</a></code>. FOr example å installere <code>dply</code>
pakken:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ssb_library.html">ssb_library</a></span><span class="op">(</span><span class="va">dplyr</span><span class="op">)</span></span></code></pre></div>
<p>Når du er fornøyd med koden din og de pakkene og funksjoner som er
brukt i produksjonsløpet, lage en “snapshot” av det.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/snapshot.html">snapshot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Dette vil skrive hvilke pakker er brukt til dependencies-filen og
lagre versjonsnummer i lock-filen.</p>
</div>
<div class="section level3">
<h3 id="bruk">Bruk et eksisterende renv miljø<a class="anchor" aria-label="anchor" href="#bruk"></a>
</h3>
<p>For å bruke et eksistende renv miljø må du først si at du ønsker å ta
i bruk renv (hvis du ikke har gjort det før) ved</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://statisticsnorway.github.io/fellesr/" class="external-link">fellesr</a></span><span class="op">)</span></span>
<span><span class="fu">init</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>For å endre og oppdatere pakkene så at de er det samme som i
lock-filen, kjøre du</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/restore.html">restore</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Du kan se hvilken pakken som er i lock-filen ved</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dependencies</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="endre">Endre et renv miljø<a class="anchor" aria-label="anchor" href="#endre"></a>
</h3>
<p>Etter tid vil du sannsynligivs får behov for å endre koden din, legge
til nye funksjonaliteter eller nye figurer osv. Hvis din nye kode er
avhengige av andre pakker trenger du å oppdatere lock-filen. Igjen,
forsøke at du har tatt i bruk renv ved</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://statisticsnorway.github.io/fellesr/" class="external-link">fellesr</a></span><span class="op">)</span></span>
<span><span class="fu">init</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>For å oppdatere lock-filen ta en snapshot</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/snapshot.html">snapshot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Hvis det er pakker du ikke ønsker å bruke lengere kan du fjerne dem
og rydde opp</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">remove</a></span><span class="op">(</span><span class="va">A3</span><span class="op">)</span></span>
<span><span class="fu">clean</span><span class="op">(</span>actions <span class="op">=</span> <span class="st">"unused.packages"</span><span class="op">)</span></span></code></pre></div>
<p><img src="https://media.giphy.com/media/Q8IqvLa3CpdzG2aons/giphy.gif"></p>
<p>For å sjekke hvilken pakke er lagret i lock-filen kan du kjøre</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">dependencies</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Susie Jentoft, Sindre Haugen.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
